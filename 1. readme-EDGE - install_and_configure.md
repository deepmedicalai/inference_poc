
## Copy Rasbian Buster Lite

### Download image

Copy url 'Raspbian Buster Lite' zip from: https://www.raspberrypi.org/downloads/raspbian/



```
cd ./raspbian
curl -O -J -L -o ./raspbian_buster_lite.zip https://downloads.raspberrypi.org/raspbian_lite_latest
```

Output fill be something like this: `2019-07-10-raspbian-buster-lite.zip`


### Unzip

Unzip downloaded file. Remove ZIP file

```
unzip 2019-07-10-raspbian-buster-lite.zip
rm -f 2019-07-10-raspbian-buster-lite.zip 
cd ..
```

Output fill be something like this: `2019-07-10-raspbian-buster-lite.img`


## Copy OS to SD card

### Get Disk id from attached USB

If you are comfortable with the command line, you can write the image to an SD card without any additional software. Open a terminal, then run:
```
diskutil list
```

Result: `/dev/disk2`

Note: Identify the disk (not the partition) of your SD card, e.g. `disk2`, not  `disk2s1`.


### Unmount disk

```
diskutil unmountDisk /dev/disk2
```

## Copy data to SD

Copy img to SD card. More info here: https://www.raspberrypi.org/documentation/installation/installing-images/mac.md

```
sudo dd bs=1m if=./raspbian/2019-07-10-raspbian-buster-lite.img of=/dev/rdisk2 conv=sync
```

Note that you provide path to IMG you downloaded and rdisk2 matches `disk2` you acquired before

### Troubleshooting of copy data
Note: When initially the above command failed with `dd: /dev/rdisk2: Permission denied`

There was a meachnical lock on SD card. Cleared. reinserted. Run to check permissions:
```
ls -l /dev/disk2
```

Had to unmount again and then `dd` started without problem

Overall, copy of 4GB took about 80 seconds on 32 SanDisk card


## Patching while on Mac

Mounting SD card back
```
diskutil mountDisk /dev/disk2 
```

Navigate to SD card on Mac

```
ls /Volumes
```
Expected output will include `boot`

Note: If the boot folder isn't showing on your computer, eject and re-insert the SD card into your computer, not the Raspberry Pi.


Change to the directory where the SD card's boot folder (containing cmdline.txt) is located. On a Mac, this will be `/Volumes/boot`. On Linux the location may vary; on recent Ubuntu installations it will be `/media/$USER/boot`

```
ls /Volumes/boot
```
Expected output will include `cmdline.txt`

### set up export Wifi parameters

```
export SSID="Dima's iPhone"
export WIFIPASS="31415926535+"
```

TEST:

```
export SSID="Something13"
export WIFIPASS="irene1BB"
```

### set permissions to `setup-pi.sh`
```
chmod +x ./setup-macoslinux/setup-edge-pi.sh
```

### run setup
```
./setup-macoslinux/setup-edge-pi.sh /Volumes/boot
```

Expected output
```
Updating /Volumes/boot/config.txt ...
Updating /Volumes/boot/cmdline.txt ...
Enabling SSH ...
Adding Wifi setup file (wpa_supplicant.conf).
```

### Eject SD card
```
sudo diskutil eject /dev/rdisk2
```